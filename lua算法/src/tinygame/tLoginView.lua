local LoginView = class("LoginView", function()
	local obj = cc.Layer:create()
    return obj
end)

function LoginView:ctor()
    cc.SpriteFrameCache:getInstance():addSpriteFrames("res/ui/loading/loadingPlist.plist")

    self.loginEventId = nil
    
    --self.widget_loading = zzy.uiViewBase:new("loading/loading")
    self.LoadingAni = sp.SkeletonAnimation:create("res/effect/loading.json", "res/effect/loading.atlas", 1)

    self:addChild(self.LoadingAni)
end

-- 游戏渲染开始
function LoginView:init(gameScene)

    local t = {a={1,2,3}, b=4}
    tJson = json.encode(t)

    local str = "{\"a\":1,\"b\":2}"
    table1 = json.decode(str)

    local data = "{\"f\":\"gd\",\"d\":{\"guide\":{\"guide\":%[9010,9020,10010,10020,10030,10050,10060,9030,10040,8001,9060,10150,10160,9070,10070,10080,10090,9040,10110,9100,10120,9080,10250,10260,10200,10210,10220,10230,10320,10330,10170,10180,10190,10240,10270,10280,10290,10340,10350,10300,10310,9092,9037%]},\"shop\":{\"firstPay\":0,\"diamondStar\":0,\"totalCharge\":0,\"samsaraCount\":5,\"chatCount\":0,\"starSoulCount\":88,\"charge14day\":%[0,0,0,0,0,0,0,0,0,0,0,0,0,0%],\"svrdays\":0,\"goldCount\":0,\"firstID\":%[%],\"diamondRefreshTask\":0},\"petcard\":{\"50016\":{\"chip\":52,\"level\":1,\"talent\":2},\"50017\":{\"chip\":3,\"level\":1,\"talent\":3},\"50014\":{\"chip\":43,\"level\":1,\"talent\":2},\"50015\":{\"chip\":87,\"level\":1,\"talent\":2},\"50018\":{\"chip\":41,\"level\":1,\"talent\":3},\"50019\":{\"chip\":9,\"level\":0,\"talent\":3},\"50012\":{\"chip\":40,\"level\":1,\"talent\":2},\"50013\":{\"chip\":3,\"level\":1,\"talent\":3},\"50010\":{\"chip\":29,\"level\":1,\"talent\":1},\"50011\":{\"chip\":112,\"level\":1,\"talent\":2},\"50025\":{\"chip\":155,\"level\":2,\"talent\":4},\"50007\":{\"chip\":104,\"level\":1,\"talent\":1},\"50008\":{\"chip\":43,\"level\":1,\"talent\":3},\"50009\":{\"chip\":1,\"level\":1,\"talent\":2},\"50003\":{\"chip\":29,\"level\":1,\"talent\":1},\"50004\":{\"chip\":26,\"level\":1,\"talent\":1},\"50005\":{\"chip\":55,\"level\":1,\"talent\":2},\"50006\":{\"chip\":138,\"level\":1,\"talent\":1},\"50001\":{\"chip\":320,\"level\":2,\"talent\":1},\"50002\":{\"chip\":60,\"level\":5,\"talent\":1},\"50020\":{\"chip\":56,\"level\":0,\"talent\":3},\"50021\":{\"chip\":134,\"level\":2,\"talent\":3},\"50022\":{\"chip\":3,\"level\":0,\"talent\":4},\"50023\":{\"chip\":4,\"level\":0,\"talent\":4},\"50024\":{\"chip\":2,\"level\":0,\"talent\":4}},\"player\":{\"id\":\"2afc6f8e-52c3-4f50-b9db-8dfbfbfda542\",\"bindfb\":\"0\",\"sourceZoneId\":1,\"changeNum\":0,\"name\":\"小江4号.s1\",\"gender\":0,\"lastLogoutTime\":1511867454,\"avatar\":0,\"registerTime\":1472265726,\"lastLoginTime\":1512372596,\"zoneId\":1,\"unid\":1000027},\"fairy\":{\"count\":0},\"userid\":1,\"totem\":{\"clean\":0,\"diamond\":0,\"soul\":0,\"own\":{\"13\":20,\"8\":25,\"7\":303,\"27\":54,\"3\":25,\"9\":50,\"29\":30,\"12\":50,\"2\":301,\"1\":100,\"6\":50,\"23\":30,\"14\":20,\"10\":17,\"25\":1,\"42\":1},\"randS\":%[\"41\",\"109\",\"108\",\"30\"%],\"randTotem\":%[\"19\",\"28\",\"24\",\"15\"%]},\"runic\":{\"s\":%[1510841273,1510841275,1510841275,1510841275,1510841276,1510841276%],\"l\":5000},\"ext\":{\"goldCard\":{\"startTime\":0,\"endTime\":0,\"sendTime\":0},\"moneyCard\":{\"startTime\":0,\"endTime\":0,\"sendTime\":0},\"mergeServerLog\":%[\"1_1\",\"1_1\"%]},\"statistics\":{\"gotSoul\":1010,\"gotGold\":\"8.14481930E 130\",\"maxLevel\":1751,\"rTime\":0,\"maxSeriesTimes\":0,\"killedBoxes\":234039,\"clickTimes\":550774,\"maxRank\":7174,\"runicCritTimes\":84189,\"maxdps\":\"4.31616277e107\",\"killedBosses\":377,\"rTimes\":30,\"magicGotLevel\":24618,\"time\":1512372596,\"playTime\":1470808848,\"srand\":0,\"killedMonsters\":284048,\"maxClickSpeed\":20},\"id\":17,\"guildWar\":%[%],\"share\":{\"today\":%[%],\"achi\":{}},\"rank\":{\"rankTop\":%[%],\"rankTime\":0,\"arenaTime\":0,\"arenaTop\":\"0\"},\"level\":{\"sStoneLevel\":1750,\"starLevel\":1750,\"afkRewardLevel\":1,\"maxLevel\":1751,\"boss\":%[1,1%],\"bossStatus\":{\"stone\":0,\"petCard\":{\"id\":0,\"num\":2,\"ty\":5},\"level\":0},\"curLevel\":1751},\"arena\":{\"oldRank\":7114,\"cardList\":%[50017,50008,50025,50018,50021%],\"reward\":1,\"reset\":50,\"pkNum\":5,\"todayRank\":7114,\"cardListFight\":{\"card\":%[{\"id\":50017,\"l\":1,\"talent\":3},{\"id\":50008,\"l\":1,\"talent\":3},{\"id\":50025,\"l\":2,\"talent\":4},{\"id\":50018,\"l\":1,\"talent\":3},{\"id\":50021,\"l\":2,\"talent\":3}%],\"attr\":{\"max_hp\":725,\"hp\":725,\"damage\":78,\"cs\":114,\"defence\":83,\"dodge\":103}}},\"money\":{\"\":0,\"90001\":9554,\"90002\":\"8.14481930e130\",\"90003\":18656,\"90004\":5476962,\"90005\":30,\"90006\":10465,\"90011\":1962420,\"90013\":0,\"90015\":1961960,\"90018\":1961960,\"90019\":1961960,\"90032\":2},\"cardFB\":{\"buyCount\":0,\"tl\":1776,\"rtime\":1511158646,\"lq\":%[0,0,0%],\"fb\":{\"50015\":{\"l\":3,\"c\":0,\"b\":0},\"50003\":{\"l\":2,\"c\":0,\"b\":0},\"50004\":{\"l\":1,\"c\":0,\"b\":0},\"50005\":{\"l\":2,\"c\":0,\"b\":0},\"50006\":{\"l\":1,\"c\":0,\"b\":0},\"50001\":{\"l\":3,\"c\":0,\"b\":0},\"50002\":{\"l\":3,\"c\":0,\"b\":0},\"50025\":{\"l\":2,\"c\":0,\"b\":0},\"50021\":{\"l\":2,\"c\":0,\"b\":0},\"50007\":{\"l\":1,\"c\":0,\"b\":0},\"50011\":{\"l\":1,\"c\":0,\"b\":0},\"50008\":{\"l\":1,\"c\":0,\"b\":0},\"50017\":{\"l\":1,\"c\":0,\"b\":0},\"50018\":{\"l\":1,\"c\":0,\"b\":0},\"50014\":{\"l\":1,\"c\":0,\"b\":0},\"50013\":{\"l\"1,\"c\":0,\"b\":0},\"50012\":{\"l\":1,\"c\":0,\"b\":0},\"50009\":{\"l\":1,\"c\":0,\"b\":0},\"50016\":{\"l\":1,\"c\":0,\"b\":0},\"50010\":{\"l\":1,\"c\":0,\"b\":0}},\"cdtime\":0},\"power\":{\"num\":80000},\"randomShop\":{\"arena\":{\"count\":10,\"cdTime\":1512403200,\"list\":%[{\"id\":20022,\"num\":0},{\"id\":20029,\"num\":0},{\"id\":20026,\"num\":0},{\"id\":20009,\"num\":0}%]},\"guild\":{\"count\":7,\"cdTime\":1472054400,\"list\":%[{\"id\":10001,\"num\":0},{\"id\":10004,\"num\":0},{\"id\":10005,\"num\":0},{\"id\":10003,\"num\":0}%]},\"black\":{\"count\":4,\"cdTime\":1511524521,\"list\":%[{\"id\":30013,\"num\":0},{\"id\":30029,\"num\":0},{\"id\":30022,\"num\":0},{\"id\":30012,\"num\":0}%]}},\"partner\":{\"hs\":%[\"20001\",\"20004\",\"20003\",\"20006\",\"20005\",\"20007\",\"20008\"%],\"lvup\":{\"20005\":1735},\"cz\":\"20001\",\"jl\":{\"20001\":\"0\",\"20004\":\"4.01175284E 132\",\"20003\":\"0\",\"20006\":2434,\"20005\":12,\"20007\":\"0\",\"20008\":\"0\"},\"ylq\":{\"20001\":\"0\",\"20004\":\"0\",\"20003\":0,\"20006\":12117,\"20005\":57,\"20007\":\"0\",\"20008\":\"0\"}},\"mine\":{\"myMineId\":0,\"occNum\":3,\"occAdd\":9999,\"attNum\":10,\"beryl\":5865},\"guild\":{\"id\":0,\"demandCdTime\":1473782400,\"flag\":0,\"enchantment\":{\"exp\":0,\"level\":1},\"warGetReward\":%[%],\"name\":\"\",\"warTokenRtime\":1512372596,\"warRewardedJH\":0,\"warRewardedLN\":0,\"warShadow\":0,\"warTokenNum\":8},\"autofightEndtime\":0,\"holyland\":{\"1\":0,\"2\":0,\"3\":0,\"4\":0,\"5\":0,\"m\":1,\"r\":0},\"firstSign\":{\"days\":8,\"count\":0,\"endTime\":1472832000,\"getReward\":%[%]},\"altar\":{\"sunCardListFight\":{\"card\":%[%],\"attr\":{\"max_hp\":0,\"hp\":0,\"damage\":0,\"cs\":0,\"defence\":0,\"dodge\":0}},\"soulCardListFight\":{\"card\":%[{\"id\":50002,\"l\":2,\"talent\":1},{\"id\":50001,\"l\":2,\"talent\":1},{\"id\":50018,\"l\":1,\"talent\":3},{\"id\":50013,\"l\":1,\"talent\":3},{\"id\":50010,\"l\":1,\"talent\":1}%],\"attr\":{\"max_hp\":623,\"hp\":623,\"damage\":79,\"cs\":91,\"defence\":122,\"dodge\":87}},\"robNum\":5,\"money\":{\"cardList\":%[50003,50025,50015,50011,50021%],\"cdTime\":1511768872,\"exnum\":0,\"exp\":51119,\"level\":14,\"maxNum\":60000,\"output\":50,\"stoneNum\":60000},\"soul\":{\"cardList\":%[50002,50001,50018,50013,50010%],\"cdTime\":1511768871,\"exnum\":0,\"exp\":36568,\"level\":7,\"maxNum\":40000,\"output\":54,\"stoneNum\":40000},\"reset\":5,\"moneyCardListFight\":{\"card\":%[{\"id\":50003,\"l\":1,\"talent\":1},{\"id\":50025,\"l\":1,\"talent\":4},{\"id\":50015,\"l\":1,\"talent\":2},{\"id\":50011,\"l\":1,\"talent\":2},{\"id\":50021,\"l\":1,\"talent\":3}%],\"attr\":{\"max_hp\":602,\"hp\":602,\"damage\":59,\"cs\":145,\"defence\":87,\"dodge\":68}},\"sun\":{\"cardList\":%[%],\"cdTime\":1511768873,\"exnum\":0,\"exp\":0,\"level\":1,\"maxNum\":20000,\"output\":50,\"stoneNum\":0}},\"starNum\":247,\"achievement\":{\"1\":{\"index\":6,\"s\":2},\"10\":{\"index\":6,\"s\":3},\"11\":{\"index\":5,\"s\":3},\"12\":{\"index\":6,\"s\":1},\"2\":{\"index\":8,\"s\":1},\"3\":{\"index\":10,\"s\":1},\"4\":{\"index\":8,\"s\":1},\"5\":{\"index\":4,\"s\":1},\"6\":{\"index\":4,\"s\":1},\"7\":{\"index\":4,\"s\":1},\"8\":{\"index\":5,\"s\":1},\"9\":{\"index\":6,\"s\":1}},\"task\":{\"sign\":0,\"power\":11,\"showTask\":{\"36\":{\"s\":1,\"num\":0},\"5\":{\"s\":1,\"num\":0},\"7\":{\"s\":1,\"num\":0},\"4\":{\"s\":1,\"num\":5},\"1\":{\"s\":1,\"num\":1}},\"taskNum\":34},\"msg\":{\"num\":%[0,5,0%]},\"festivity\":%[%],\"sign\":{\"totalDays\":13,\"count\":1,\"days\":4,\"status\":0},\"familiar\":{\"see\":%[%],\"cur\":25002,\"own\":{\"25001\":{\"l\":1},\"25002\":{\"l\":1},\"25003\":{\"l\":1}}},\"holiday\":{\"list\":%[null,{\"cfgid\":\"shdrd01\",\"type\":1018,\"openTime\":1512316800,\"endTime\":1512748799,\"proNum\":5,\"hdata\":{\"canData\":%[%],\"getData\":%[%],\"times\":0,\"rewardNum\":{\"23\":1,\"24\":1,\"25\":1,\"26\":1,\"27\":1}}},{\"cfgid\":\"rcxfhk100\",\"type\":1012,\"openTime\":1512316800,\"endTime\":1512403199,\"hdata\":{\"getReward\":%[%],\"diamond\":0}},{\"cfgid\":\"bandit01\",\"type\":1019,\"openTime\":1512316800,\"endTime\":1512403199,\"hdata\":0},{\"cfgid\":\"rcczhk106\",\"type\":1011,\"openTime\":1512316800,\"endTime\":1512403199,\"hdata\":{\"getReward\":%[%],\"diamond\":0}},{\"cfgid\":\"altar01\",\"type\":1009,\"openTime\":1512316800,\"endTime\":1512403199,\"hdata\":{\"ratio\":2}}%]},\"warpath\":{\"hp\":0,\"statue\":0,\"index\":0,\"times\":0,\"bosses\":%[1,8,6,17,8,14,9,8,5,7,17,11,4,18,12,18,11,5,17,15,15,6,20,3,20,5,19,1,18,12,18,19,19,3,16,6,16,4,14,1,11,10,11,14,8,3,12,18,7,9,13,2,14,12,4,14,17,3,14,14,14,12,13,13,14,8,18,10,11,12,10,1,2,1,15,9,4,6,7,10,14,20,11,8,11,15,1,8,17,15,2,10,6,14,2,19,1,20,9,12,12,19,12,13,19,7,2,3,13,8,12,6,7,3,14,18,18,14,5,14,8,6,3,13,20,5,12,20,4,20,11,16,19,3,8,18,9,10,20,1,18,11,7,5,14,20,2,11,13,7,5,1,13,7,13,12,12,5,12,16,5,2,11,3,4,18,20,13,7,19,14,4,10,20,8,4,20,10,14,13,17,19,13,9,5,6,1,17,10,12,12,15,14,2,17,17,19,16,10,6%],\"stage\":1},\"buylimit\":{},\"magic\":{\"19\":{\"s\":11,\"l\":1},\"22\":{\"s\":10,\"l\":1},\"17\":{\"s\":5,\"l\":1},\"23\":{\"s\":7,\"l\":1},\"18\":{\"s\":9,\"l\":1},\"24\":{\"s\":3,\"l\":451},\"15\":{\"s\":10,\"l\":1},\"25\":{\"s\":57,\"l\":2886},\"16\":{\"s\":7,\"l\":1},\"13\":{\"s\":4,\"l\":1},\"14\":{\"s\":7,\"l\":1},\"11\":{\"s\":17,\"l\":1},\"12\":{\"s\":9,\"l\":1},\"3\":{\"s\":8,\"l\":3161},\"21\":{\"s\":7,\"l\":1},\"20\":{\"s\":4,\"l\":1},\"2\":{\"s\":2,\"l\":3005},\"1\":{\"s\":9,\"l\":3008},\"10\":{\"s\":15,\"l\":1},\"7\":{\"s\":4,\"l\":3002},\"6\":{\"s\":0,\"l\":3003},\"5\":{\"s\":0,\"l\":3002},\"4\":{\"s\":12,\"l\":3101},\"9\":{\"s\":12,\"l\":1},\"8\":{\"s\":18,\"l\":4}},\"offLineGold\":{\"num\":\"3.43140936E 135\",\"reward\":%[%]},\"autofight\":%[%],\"buff\":{\"sStone\":1506521963,\"manyGold\":1511513694,\"card\":1511596504,\"inspire\":1511171228},\"defend\":{\"times\":0,\"maxScore\":25,\"cdtime\":1506441676},\"fightValue\":531,\"cht\":{\"cache\":%[%]}},\"oseq\":1}"
    local jData = json.decode(data)
    ch.ModelManager:init(jData.d)
    ch.UIManager:init(gameScene)
    self:goinGame()
end

---
-- 进入游戏界面
-- @function [parent=#LoginView] goinGame
-- @param #LoginView self
function LoginView:goinGame()
    INFO("[%s]", "LoginView:goinGame")
    
    ch.GameLoaderModel.loadingCom = true
    zzy.TimerUtils:setTimeOut(0,function()
        if ch.guide.firstIn then
            ch.LevelController:init(false)
        else
            ch.LevelController:init(true)
        end
        --                                ch.UIManager:getActiveSkillLayer():addChild(zzy.uiViewBase:new("MainScreen/W3_Skill"))
        ch.UIManager:addActiveSkillView()
        ch.UIManager:addMainView()
        zzy.EventManager:dispatch({type = ch.GameLoaderModel.loadCompletedEvent})

        zzy.TimerUtils:setTimeOut(0, function()
            cc.SpriteFrameCache:getInstance():removeSpriteFramesFromFile("res/ui/loading/loadingPlist.plist")
        end)
    end)
end


return LoginView